## рдЖрдк рдХреНрдпрд╛ рд╕реАрдЦреЗрдВрдЧреЗ

рдЗрд╕ рд▓реИрдм рдореЗрдВ, рдЖрдк Model Context Protocol (MCP) рдФрд░ [PostgreSQL Vector](https://github.com/pgvector/pgvector){:target="_blank"} extension enabled рдХреЗ рд╕рд╛рде PostgreSQL рдбреЗрдЯрд╛рдмреЗрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ Azure AI Agent рдореЗрдВ semantic search рдХреНрд╖рдорддрд╛рдУрдВ рдХреЛ рд╕рдХреНрд╖рдо рдХрд░рддреЗ рд╣реИрдВред

## рдкрд░рд┐рдЪрдп

рдпрд╣ рд▓реИрдм Model Context Protocol (MCP) рдФрд░ PostgreSQL рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ Azure AI Agent рдХреЛ semantic search рдХреЗ рд╕рд╛рде рдЕрдкрдЧреНрд░реЗрдб рдХрд░рддреА рд╣реИред рдкреНрд░реЛрдбрдХреНрдЯ рдирд╛рдо рдФрд░ рд╡рд┐рд╡рд░рдгреЛрдВ рдХреЛ OpenAI embedding model (text-embedding-3-small) рдХреЗ рд╕рд╛рде vectors рдореЗрдВ рдмрджрд▓рд╛ рдЧрдпрд╛ рдФрд░ рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВ store рдХрд┐рдпрд╛ рдЧрдпрд╛ред рдпрд╣ рдПрдЬреЗрдВрдЯ рдХреЛ user intent рд╕рдордЭрдиреЗ рдФрд░ рдЕрдзрд┐рдХ рд╕рдЯреАрдХ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдПрдВ рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рдмрдирд╛рддрд╛ рд╣реИред

## рд▓реИрдм рдПрдХреНрд╕рд░рд╕рд╛рдЗрдЬрд╝

рдкрд┐рдЫрд▓реА рд▓реИрдм рд╕реЗ рдЖрдк рдПрдЬреЗрдВрдЯ рд╕реЗ рд╕реЗрд▓реНрд╕ рдбреЗрдЯрд╛ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдкреНрд░рд╢реНрди рдкреВрдЫ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдпрд╣ exact matches рддрдХ рд╕реАрдорд┐рдд рдерд╛ред рдЗрд╕ рд▓реИрдм рдореЗрдВ, рдЖрдк Model Context Protocol (MCP) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ semantic search implement рдХрд░рдХреЗ рдПрдЬреЗрдВрдЯ рдХреА рдХреНрд╖рдорддрд╛рдУрдВ рдХреЛ рд╡рд┐рд╕реНрддрд╛рд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВред рдпрд╣ рдПрдЬреЗрдВрдЯ рдХреЛ рдЙрди рдХреНрд╡реЗрд░реАрдЬрд╝ рдХреЛ рд╕рдордЭрдиреЗ рдФрд░ рдЙрдирдХрд╛ рдЬрд╡рд╛рдм рджреЗрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдЧрд╛ рдЬреЛ exact matches рдирд╣реАрдВ рд╣реИрдВ, рдЬрдЯрд┐рд▓ рдкреНрд░рд╢реНрдиреЛрдВ рдХреЗ рд╕рд╛рде рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреА рд╕рд╣рд╛рдпрддрд╛ рдХрд░рдиреЗ рдХреА рдЗрд╕рдХреА рдХреНрд╖рдорддрд╛ рдореЗрдВ рд╕реБрдзрд╛рд░ рдХрд░реЗрдЧрд╛ред

1. рдЕрдкрдиреЗ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдореЗрдВ Web Chat tab рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреНрд░рд╢реНрди рдХреЛ рдкреЗрд╕реНрдЯ рдХрд░реЗрдВ:

    ```text
    18A breakers рдХреЗ рд╕рд╛рде рд╡рд┐рднрд┐рдиреНрди рд╕реНрдЯреЛрд░реНрд╕ рдХрд╛ рдкреНрд░рджрд░реНрд╢рди рдХреИрд╕рд╛ рд░рд╣рд╛?
    ```

    рдПрдЬреЗрдВрдЯ рдЬрд╡рд╛рдм рджреЗрддрд╛ рд╣реИ: "рдореБрдЭреЗ рд╣рдорд╛рд░реЗ рд░рд┐рдХреЙрд░реНрдбреНрд╕ рдореЗрдВ 18A breakers рдХреЗ рд▓рд┐рдП рдХреЛрдИ рд╕реЗрд▓реНрд╕ рдбреЗрдЯрд╛ рдирд╣реАрдВ рдорд┐рд▓рд╛ред ЁЯШ▒ рд╣рд╛рд▓рд╛рдВрдХрд┐, рдпрд╣рд╛рдВ рдХреБрдЫ similar рдкреНрд░реЛрдбрдХреНрдЯреНрд╕ рдХреЗ рд╕реБрдЭрд╛рд╡ рд╣реИрдВ рдЬрд┐рдиреНрд╣реЗрдВ рдЖрдк explore рдХрд░рдирд╛ рдЪрд╛рд╣ рд╕рдХрддреЗ рд╣реИрдВред" рдРрд╕рд╛ рдЗрд╕рд▓рд┐рдП рд╣реЛрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдПрдЬреЗрдВрдЯ рдХреЗрд╡рд▓ keywords рджреНрд╡рд╛рд░рд╛ matching queries рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЖрдкрдХреЗ рдкреНрд░рд╢реНрди рдХреЗ semantic meaning рдХреЛ рдирд╣реАрдВ рд╕рдордЭрддрд╛ред LLM рдЕрднреА рднреА рдХрд┐рд╕реА рднреА рдкреНрд░реЛрдбрдХреНрдЯ рд╕рдВрджрд░реНрдн рд╕реЗ educated рдкреНрд░реЛрдбрдХреНрдЯ рд╕реБрдЭрд╛рд╡ рджреЗ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рдЙрд╕рдХреЗ рдкрд╛рд╕ рдкрд╣рд▓реЗ рд╕реЗ рд╣реЛред

## Semantic Search рдХреЛ Implement рдХрд░рдирд╛

рдЗрд╕ section рдореЗрдВ, рдЖрдк рдПрдЬреЗрдВрдЯ рдХреА рдХреНрд╖рдорддрд╛рдУрдВ рдХреЛ рдмрдврд╝рд╛рдиреЗ рдХреЗ рд▓рд┐рдП Model Context Protocol (MCP) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ semantic search implement рдХрд░реЗрдВрдЧреЗред

1. VS Code Command Palette **рдЦреЛрд▓рдиреЗ** рдХреЗ рд▓рд┐рдП <kbd>F1</kbd> рджрдмрд╛рдПрдВред
2. **Open File** рдЯрд╛рдЗрдк рдХрд░реЗрдВ рдФрд░ **File: Open File...** рд╕реЗрд▓реЗрдХреНрдЯ рдХрд░реЗрдВред
3. file picker рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд path рдХреЛ **рдкреЗрд╕реНрдЯ** рдХрд░реЗрдВ рдФрд░ <kbd>Enter</kbd> рджрдмрд╛рдПрдВ:

    ```text
    /workspace/src/python/mcp_server/sales_analysis/sales_analysis.py
    ```

4. рд▓рдЧрднрдЧ line 100 рддрдХ scroll down рдХрд░реЗрдВ рдФрд░ `semantic_search_products` method рдХреЛ рдЦреЛрдЬреЗрдВред рдпрд╣ method рд╕реЗрд▓реНрд╕ рдбреЗрдЯрд╛ рдкрд░ semantic search perform рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд┐рдореНрдореЗрджрд╛рд░ рд╣реИред рдЖрдк рджреЗрдЦреЗрдВрдЧреЗ рдХрд┐ **@mcp.tool()** decorator рдХреЛ commented out рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред рдпрд╣ decorator method рдХреЛ MCP tool рдХреЗ рд░реВрдк рдореЗрдВ register рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдПрдЬреЗрдВрдЯ рджреНрд╡рд╛рд░рд╛ рдЗрд╕реЗ call рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред

5. Line рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ `#` рдХреЛ рд╣рдЯрд╛рдХрд░ `@mcp.tool()` decorator рдХреЛ uncomment рдХрд░реЗрдВред рдпрд╣ semantic search tool рдХреЛ рд╕рдХреНрд╖рдо рдХрд░реЗрдЧрд╛ред

    ```python
    # @mcp.tool()
    async def semantic_search_products(
        ctx: Context,
        query_description: Annotated[str, Field(
        ...
    ```

6. рдЗрд╕рдХреЗ рдмрд╛рдж, рдЖрдкрдХреЛ Agent instructions рдХреЛ semantic search tool рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдХреНрд╖рдо рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред `app.py` рдлрд╛рдЗрд▓ рдкрд░ рд╡рд╛рдкрд╕ switch рдХрд░реЗрдВред
7. рд▓рдЧрднрдЧ line 30 рддрдХ scroll down рдХрд░реЗрдВ рдФрд░ `# INSTRUCTIONS_FILE = "instructions/mcp_server_tools_with_semantic_search.txt"` line рдХреЛ рдЦреЛрдЬреЗрдВред
8. рд╢реБрд░реБрдЖрдд рдореЗрдВ `#` рдХреЛ рд╣рдЯрд╛рдХрд░ line рдХреЛ uncomment рдХрд░реЗрдВред рдпрд╣ рдПрдЬреЗрдВрдЯ рдХреЛ semantic search tool рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рдХрд░реЗрдЧрд╛ред

    ```python
    INSTRUCTIONS_FILE = "instructions/mcp_server_tools_with_semantic_search.txt"
    ```

## Agent Instructions рдХреА рд╕рдореАрдХреНрд╖рд╛ рдХрд░рдирд╛

1. VS Code Command Palette рдЦреЛрд▓рдиреЗ рдХреЗ рд▓рд┐рдП <kbd>F1</kbd> рджрдмрд╛рдПрдВред
2. **Open File** рдЯрд╛рдЗрдк рдХрд░реЗрдВ рдФрд░ **File: Open File...** рд╕реЗрд▓реЗрдХреНрдЯ рдХрд░реЗрдВред
3. file picker рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд path рдХреЛ рдкреЗрд╕реНрдЯ рдХрд░реЗрдВ рдФрд░ <kbd>Enter</kbd> рджрдмрд╛рдПрдВ:

    ```text
    /workspace/src/shared/instructions/mcp_server_tools_with_semantic_search.txt
    ```

4. рдлрд╛рдЗрд▓ рдореЗрдВ instructions рдХреА рд╕рдореАрдХреНрд╖рд╛ рдХрд░реЗрдВред рдпреЗ instructions рдПрдЬреЗрдВрдЯ рдХреЛ рд╕реЗрд▓реНрд╕ рдбреЗрдЯрд╛ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдкреНрд░рд╢реНрдиреЛрдВ рдХреЗ рдЙрддреНрддрд░ рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП semantic search tool рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рдирд┐рд░реНрджреЗрд╢ рджреЗрддреЗ рд╣реИрдВред

## Semantic Search Tool рдХреЗ рд╕рд╛рде Agent App рд╢реБрд░реВ рдХрд░рдирд╛

1. <kbd>Shift + F5</kbd> рджрдмрд╛рдХрд░ рд╡рд░реНрддрдорд╛рди рдПрдЬреЗрдВрдЯ рдРрдк рдХреЛ **рд░реЛрдХреЗрдВ**ред
2. <kbd>F5</kbd> рджрдмрд╛рдХрд░ рдПрдЬреЗрдВрдЯ рдРрдк рдХреЛ **рдкреБрдирдГ рдЖрд░рдВрдн** рдХрд░реЗрдВред рдпрд╣ updated instructions рдФрд░ semantic search tool enabled рдХреЗ рд╕рд╛рде рдПрдЬреЗрдВрдЯ рдХреЛ рд╢реБрд░реВ рдХрд░реЗрдЧрд╛ред
3. рдЕрдкрдиреЗ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдореЗрдВ **Web Chat** tab рдкрд░ рд╡рд╛рдкрд╕ switch рдХрд░реЗрдВред
4. рдЪреИрдЯ рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреНрд░рд╢реНрди рджрд░реНрдЬ рдХрд░реЗрдВ:

    ```text
    18A breakers рдХреЗ рд╕рд╛рде рд╡рд┐рднрд┐рдиреНрди рд╕реНрдЯреЛрд░реНрд╕ рдХрд╛ рдкреНрд░рджрд░реНрд╢рди рдХреИрд╕рд╛ рд░рд╣рд╛?
    ```

    рдПрдЬреЗрдВрдЯ рдЕрдм рдкреНрд░рд╢реНрди рдХреЗ semantic meaning рдХреЛ рд╕рдордЭрддрд╛ рд╣реИ рдФрд░ relevant рд╕реЗрд▓реНрд╕ рдбреЗрдЯрд╛ рдХреЗ рд╕рд╛рде рддрджрдиреБрд╕рд╛рд░ рдЬрд╡рд╛рдм рджреЗрддрд╛ рд╣реИред

    !!! info "рдиреЛрдЯ"
        MCP Semantic Search tool рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ:

        1. рдкреНрд░рд╢реНрди рдХреЛ рдкреНрд░реЛрдбрдХреНрдЯ рд╡рд┐рд╡рд░рдгреЛрдВ рдХреЗ рд╕рдорд╛рди OpenAI embedding model (text-embedding-3-small) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ vector рдореЗрдВ рдмрджрд▓рд╛ рдЬрд╛рддрд╛ рд╣реИред
        2. рдЗрд╕ vector рдХрд╛ рдЙрдкрдпреЛрдЧ PostgreSQL рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВ similar рдкреНрд░реЛрдбрдХреНрдЯ vectors рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
        3. рдПрдЬреЗрдВрдЯ рдХреЛ рдкрд░рд┐рдгрд╛рдо рдкреНрд░рд╛рдкреНрдд рд╣реЛрддреЗ рд╣реИрдВ рдФрд░ рд╡реЗ рдЙрдирдХрд╛ рдЙрдкрдпреЛрдЧ response рдЬреЗрдирд░реЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░рддреЗ рд╣реИрдВред

*GitHub Copilot рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдиреБрд╡рд╛рджрд┐рддред*
