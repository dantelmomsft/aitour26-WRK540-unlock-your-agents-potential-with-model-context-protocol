## рдЖрдк рдХреНрдпрд╛ рд╕реАрдЦреЗрдВрдЧреЗ

рдЗрд╕ рд▓реИрдм рдореЗрдВ, рдЖрдк Model Context Protocol (MCP) рдФрд░ PostgreSQL рдбреЗрдЯрд╛рдмреЗрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ Azure AI Agent рдореЗрдВ semantic search рдХреНрд╖рдорддрд╛рдУрдВ рдХреЛ рд╕рдХреНрд╖рдо рдХрд░рддреЗ рд╣реИрдВред

## рдкрд░рд┐рдЪрдп

рдпрд╣ рд▓реИрдм Model Context Protocol (MCP) рдФрд░ PostgreSQL рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ Azure AI Agent рдХреЛ semantic search рдХреЗ рд╕рд╛рде рдЕрдкрдЧреНрд░реЗрдб рдХрд░рддреА рд╣реИред рдЙрддреНрдкрд╛рдж рдирд╛рдо рдФрд░ рд╡рд┐рд╡рд░рдг рдХреЛ OpenAI embedding model (text-embedding-3-small) рдХреЗ рд╕рд╛рде vectors рдореЗрдВ рд░реВрдкрд╛рдВрддрд░рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдФрд░ рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд┐рдпрд╛ рдЧрдпрд╛ред рдпрд╣ рдПрдЬреЗрдВрдЯ рдХреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдЗрд░рд╛рджреЗ рдХреЛ рд╕рдордЭрдиреЗ рдФрд░ рдЕрдзрд┐рдХ рд╕рдЯреАрдХ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛рдПрдВ рдкреНрд░рджрд╛рди рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред

## рд▓реИрдм рдЕрднреНрдпрд╛рд╕

рдкрд┐рдЫрд▓реА рд▓реИрдм рд╕реЗ рдЖрдк рдПрдЬреЗрдВрдЯ рд╕реЗ рдмрд┐рдХреНрд░реА рдбреЗрдЯрд╛ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕рд╡рд╛рд▓ рдкреВрдЫ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдпрд╣ рд╕рдЯреАрдХ рдореИрдЪ рддрдХ рд╕реАрдорд┐рдд рдерд╛ред рдЗрд╕ рд▓реИрдм рдореЗрдВ, рдЖрдк Model Context Protocol (MCP) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ semantic search рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдХреЗ рдПрдЬреЗрдВрдЯ рдХреА рдХреНрд╖рдорддрд╛рдУрдВ рдХреЛ рдмрдврд╝рд╛рддреЗ рд╣реИрдВред рдпрд╣ рдПрдЬреЗрдВрдЯ рдХреЛ рдЙрди рдХреНрд╡реЗрд░реАрдЬрд╝ рдХреЛ рд╕рдордЭрдиреЗ рдФрд░ рдЙрдирдХрд╛ рдЬрд╡рд╛рдм рджреЗрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдЧрд╛ рдЬреЛ рд╕рдЯреАрдХ рдореИрдЪ рдирд╣реАрдВ рд╣реИрдВ, рдЕрдзрд┐рдХ рдЬрдЯрд┐рд▓ рдкреНрд░рд╢реНрдиреЛрдВ рдХреЗ рд╕рд╛рде рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреА рд╕рд╣рд╛рдпрддрд╛ рдХрд░рдиреЗ рдХреА рдЗрд╕рдХреА рдХреНрд╖рдорддрд╛ рдореЗрдВ рд╕реБрдзрд╛рд░ рдХрд░рддрд╛ рд╣реИред

1. рдЕрдкрдиреЗ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдореЗрдВ Web Chat рдЯреИрдм рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреНрд░рд╢реНрди рдкреЗрд╕реНрдЯ рдХрд░реЗрдВ:

    ```text
    How did different stores perform with 18A breakers?
    ```

    рдПрдЬреЗрдВрдЯ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рджреЗрддрд╛ рд╣реИ: "I couldn't find any sales data for 18A breakers in our records. ЁЯШ▒ However, here are some suggestions for similar products you might want to explore." рдРрд╕рд╛ рдЗрд╕рд▓рд┐рдП рд╣реЛрддрд╛ рд╣реИ рдХреНрдпреЛрдВрдХрд┐ рдПрдЬреЗрдВрдЯ рдХреЗрд╡рд▓ keywords рджреНрд╡рд╛рд░рд╛ matching queries рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЖрдкрдХреЗ рдкреНрд░рд╢реНрди рдХреЗ semantic рдЕрд░реНрде рдХреЛ рдирд╣реАрдВ рд╕рдордЭрддрд╛ред LLM рдЕрднреА рднреА рдХрд┐рд╕реА рднреА рдЙрддреНрдкрд╛рдж рд╕рдВрджрд░реНрдн рд╕реЗ рд╢рд┐рдХреНрд╖рд┐рдд рдЙрддреНрдкрд╛рдж рд╕реБрдЭрд╛рд╡ рджреЗ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рдЙрд╕рдХреЗ рдкрд╛рд╕ рдкрд╣рд▓реЗ рд╕реЗ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред

## Semantic Search рд▓рд╛рдЧреВ рдХрд░рдирд╛

рдЗрд╕ рдЕрдиреБрднрд╛рдЧ рдореЗрдВ, рдЖрдк рдПрдЬреЗрдВрдЯ рдХреА рдХреНрд╖рдорддрд╛рдУрдВ рдХреЛ рдмрдврд╝рд╛рдиреЗ рдХреЗ рд▓рд┐рдП Model Context Protocol (MCP) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ semantic search рдХреЛ рд▓рд╛рдЧреВ рдХрд░реЗрдВрдЧреЗред

1. VS Code Command Palette **рдЦреЛрд▓рдиреЗ** рдХреЗ рд▓рд┐рдП <kbd>F1</kbd> рджрдмрд╛рдПрдВред
2. **Open File** рдЯрд╛рдЗрдк рдХрд░реЗрдВ рдФрд░ **File: Open File...** рдХрд╛ рдЪрдпрди рдХрд░реЗрдВред
3. рдлрд╛рдЗрд▓ рдкрд┐рдХрд░ рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкрд╛рде **рдкреЗрд╕реНрдЯ** рдХрд░реЗрдВ рдФрд░ <kbd>Enter</kbd> рджрдмрд╛рдПрдВ:

    ```text
    /workspace/src/python/mcp_server/sales_analysis/sales_analysis.py
    ```

4. рд▓рдЧрднрдЧ рд▓рд╛рдЗрди 100 рддрдХ рдиреАрдЪреЗ рд╕реНрдХреНрд░реЙрд▓ рдХрд░реЗрдВ рдФрд░ `semantic_search_products` method рдХреЛ рджреЗрдЦреЗрдВред рдпрд╣ method рдмрд┐рдХреНрд░реА рдбреЗрдЯрд╛ рдкрд░ semantic search рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд┐рдореНрдореЗрджрд╛рд░ рд╣реИред рдЖрдк рджреЗрдЦреЗрдВрдЧреЗ рдХрд┐ **@mcp.tool()** decorator commented out рд╣реИред рдпрд╣ decorator method рдХреЛ MCP tool рдХреЗ рд░реВрдк рдореЗрдВ register рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬрд┐рд╕рд╕реЗ рдПрдЬреЗрдВрдЯ рдЗрд╕реЗ рдХреЙрд▓ рдХрд░ рд╕рдХрддрд╛ рд╣реИред

5. рд▓рд╛рдЗрди рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ `#` рдХреЛ рд╣рдЯрд╛рдХрд░ `@mcp.tool()` decorator рдХреЛ uncomment рдХрд░реЗрдВред рдпрд╣ semantic search tool рдХреЛ рд╕рдХреНрд╖рдо рдХрд░реЗрдЧрд╛ред

    ```python
    # @mcp.tool()
    async def semantic_search_products(
        ctx: Context,
        query_description: Annotated[str, Field(
        ...
    ```

6. рдЗрд╕рдХреЗ рдмрд╛рдж, рдЖрдкрдХреЛ semantic search tool рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП Agent instructions рдХреЛ рд╕рдХреНрд╖рдо рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред `app.py` рдлрд╛рдЗрд▓ рдкрд░ рд╡рд╛рдкрд╕ рд╕реНрд╡рд┐рдЪ рдХрд░реЗрдВред
7. рд▓рдЧрднрдЧ рд▓рд╛рдЗрди 30 рддрдХ рдиреАрдЪреЗ рд╕реНрдХреНрд░реЙрд▓ рдХрд░реЗрдВ рдФрд░ `# INSTRUCTIONS_FILE = "instructions/mcp_server_tools_with_semantic_search.txt"` рд▓рд╛рдЗрди рдЦреЛрдЬреЗрдВред
8. рд╢реБрд░реБрдЖрдд рдореЗрдВ `#` рдХреЛ рд╣рдЯрд╛рдХрд░ рд▓рд╛рдЗрди рдХреЛ uncomment рдХрд░реЗрдВред рдпрд╣ рдПрдЬреЗрдВрдЯ рдХреЛ semantic search tool рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдЧрд╛ред

    ```python
    INSTRUCTIONS_FILE = "instructions/mcp_server_tools_with_semantic_search.txt"
    ```

## Agent Instructions рдХреА рд╕рдореАрдХреНрд╖рд╛

1. VS Code Command Palette рдЦреЛрд▓рдиреЗ рдХреЗ рд▓рд┐рдП <kbd>F1</kbd> рджрдмрд╛рдПрдВред
2. **Open File** рдЯрд╛рдЗрдк рдХрд░реЗрдВ рдФрд░ **File: Open File...** рдХрд╛ рдЪрдпрди рдХрд░реЗрдВред
3. рдлрд╛рдЗрд▓ рдкрд┐рдХрд░ рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкрд╛рде рдкреЗрд╕реНрдЯ рдХрд░реЗрдВ рдФрд░ <kbd>Enter</kbd> рджрдмрд╛рдПрдВ:

    ```text
    /workspace/src/shared/instructions/mcp_server_tools_with_semantic_search.txt
    ```

4. рдлрд╛рдЗрд▓ рдореЗрдВ рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХреА рд╕рдореАрдХреНрд╖рд╛ рдХрд░реЗрдВред рдпреЗ рдирд┐рд░реНрджреЗрд╢ рдПрдЬреЗрдВрдЯ рдХреЛ рдмрд┐рдХреНрд░реА рдбреЗрдЯрд╛ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕рд╡рд╛рд▓реЛрдВ рдХреЗ рдЬрд╡рд╛рдм рджреЗрдиреЗ рдХреЗ рд▓рд┐рдП semantic search tool рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрджреЗрд╢ рджреЗрддреЗ рд╣реИрдВред

## Semantic Search Tool рдХреЗ рд╕рд╛рде Agent App рд╢реБрд░реВ рдХрд░рдирд╛

1. <kbd>Shift + F5</kbd> рджрдмрд╛рдХрд░ рд╡рд░реНрддрдорд╛рди рдПрдЬреЗрдВрдЯ рдРрдк рдХреЛ **рд░реЛрдХреЗрдВ**ред
2. <kbd>F5</kbd> рджрдмрд╛рдХрд░ рдПрдЬреЗрдВрдЯ рдРрдк рдХреЛ **рдкреБрдирдГ рдЖрд░рдВрдн** рдХрд░реЗрдВред рдпрд╣ рдПрдЬреЗрдВрдЯ рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд┐рдП рдЧрдП рдирд┐рд░реНрджреЗрд╢реЛрдВ рдФрд░ рд╕рдХреНрд╖рдо semantic search tool рдХреЗ рд╕рд╛рде рд╢реБрд░реВ рдХрд░реЗрдЧрд╛ред
3. рдЕрдкрдиреЗ рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдореЗрдВ **Web Chat** рдЯреИрдм рдкрд░ рд╡рд╛рдкрд╕ рд╕реНрд╡рд┐рдЪ рдХрд░реЗрдВред
4. рдЪреИрдЯ рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдкреНрд░рд╢реНрди рджрд░реНрдЬ рдХрд░реЗрдВ:

    ```text
    How did different stores perform with 18A breakers?
    ```

    рдПрдЬреЗрдВрдЯ рдЕрдм рдкреНрд░рд╢реНрди рдХреЗ semantic рдЕрд░реНрде рдХреЛ рд╕рдордЭрддрд╛ рд╣реИ рдФрд░ рд╕рдВрдмрдВрдзрд┐рдд рдмрд┐рдХреНрд░реА рдбреЗрдЯрд╛ рдХреЗ рд╕рд╛рде рддрджрдиреБрд╕рд╛рд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рджреЗрддрд╛ рд╣реИред

    !!! info "рдиреЛрдЯ"
        MCP Semantic Search tool рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рддрд░реАрдХреЗ рд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ:

        1. рдкреНрд░рд╢реНрди рдХреЛ рдЙрддреНрдкрд╛рдж рд╡рд┐рд╡рд░рдг рдХреЗ рд╕рдорд╛рди OpenAI embedding model (text-embedding-3-small) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ vector рдореЗрдВ рд░реВрдкрд╛рдВрддрд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
        2. рдЗрд╕ vector рдХрд╛ рдЙрдкрдпреЛрдЧ PostgreSQL рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВ рд╕рдорд╛рди рдЙрддреНрдкрд╛рдж vectors рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред
        3. рдПрдЬреЗрдВрдЯ рдкрд░рд┐рдгрд╛рдо рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЙрдирдХрд╛ рдЙрдкрдпреЛрдЧ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рдЬреЗрдирд░реЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд░рддрд╛ рд╣реИред

*GitHub Copilot рдФрд░ GPT-4o рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдиреБрд╡рд╛рджрд┐рддред*
